# PHP7+MySQL5.6 查立得轻量级公交查询系统

## 系统简介

本系统是一个基于PHP7和MySQL5.6的轻量级公交查询系统(40KB级)，支持线路查询、站点查询和换乘查询功能。系统采用原生PHP+MySQL开发，无需第三方框架，适合手机端访问。
首发版本，未经实际检验，仅供学习参考。

## 环境要求

- PHP 7.1+
- MySQL 5.6+
- mysqli扩展
- json扩展
- 可写入权限的inc目录

## 安装步骤

1. 将所有文件上传到网站根目录
2. 修改inc/conn.php中的数据库连接信息
3. 访问install.php进行安装
4. 根据安装向导完成安装
5. 安装完成后，系统会自动跳转到首页

## 默认账户和密码

- 管理员账号: admin
- 管理员密码: admin123

## 文件结构

```
bus_system/
├── index.php               # 前台入口文件
├── adm.php                 # 管理员入口文件
├── install.php             # 安装文件
├── readme.txt              # 说明文档
├── inc/                    # 公共文件目录
│   ├── conn.php            # 数据库连接配置
│   ├── pubs.php            # 公共PHP函数
│   ├── sqls.php            # 数据库操作类
│   ├── js.js               # 公共JavaScript函数
│   ├── pubs.css            # 公共CSS样式
│   ├── head.php            # 公共头部
│   ├── foot.php            # 公共底部
│   ├── site.json.php       # 网站设置缓存
│   ├── user.json.php       # 管理员账号缓存
│   ├── type1.json          # 线路查询记录
│   ├── type2.json          # 站点查询记录
│   ├── type3.json          # 换乘查询记录
├── main/                   # 前台模块目录
│   ├── main.php            # 首页
│   ├── zhan.php            # 站点列表页
│   ├── xian.php            # 线路列表页
│   ├── zshow.php           # 站点详情页
│   ├── xshow.php           # 线路详情页
│   ├── hshow.php           # 换乘方案结果页
├── adm/                    # 管理模块目录
│   ├── login.php           # 登录页面
│   ├── lgout.php           # 退出登录
│   ├── pass.php            # 修改密码
│   ├── site.php            # 系统设置
│   ├── zhan.php            # 站点管理
│   ├── xian.php            # 线路管理
│   ├── gaix.php            # 线路站点管理
```

## 数据库结构

### 线路表(line)

| 字段名 | 类型 | 描述 | 是否必填 |
|-------|------|------|---------|
| id | int | 自增ID | 是 |
| name | varchar(100) | 线路名称 | 是 |
| type | varchar(100) | 线路类别 | 否 |
| time | varchar(1024) | 运行时间 | 否 |
| gtime | varchar(50) | 最后更新时间 | 否 |
| start | varchar(100) | 起始站点 | 否 |
| end | varchar(100) | 终点站 | 否 |
| comp | varchar(100) | 运营公司 | 否 |
| note | text | 备注 | 否 |
| fare | varchar(256) | 费用 | 否 |
| zlist | text | 站点正向(升序排列，-号开头结尾分隔) | 否 |
| flist | text | 站点反程(升序排列，-号开头结尾分隔) | 否 |

### 站点表(zhan)

| 字段名 | 类型 | 描述 | 是否必填 |
|-------|------|------|---------|
| zid | int | 自增ID | 是 |
| zhan | varchar(100) | 站点名称 | 是 |
| ping | varchar(100) | 站点拼音 | 否 |
| lng | varchar(16) | 经度 | 否 |
| lat | varchar(16) | 纬度 | 否 |

## 功能说明

### 前台功能

1. 首页(main.php)
   - 显示历史查询记录，包括线路查询、站点查询和换乘查询记录
   - 提供查询联想词功能:均可下拉提示词。

2. 站点列表页(zhan.php)
   - 分页显示所有站点
   - 支持按站点名称搜索

3. 线路列表页(xian.php)
   - 分页显示所有线路
   - 支持按线路名称搜索

4. 站点详情页(zshow.php)
   - 显示站点基本信息
   - 显示经过该站点的线路
   - 显示站点位置地图
   - 显示站点查询历史记录

5. 线路详情页(xshow.php)
   - 显示线路基本信息
   - 显示线路站点地图
   - 显示正向站点列表
   - 显示反向站点列表
   - 显示线路查询历史记录

6. 换乘方案结果页(hshow.php)
   - 显示起点站到终点站的换乘方案
   - 支持直达、一次换乘和二次换乘方案
   - 显示换乘查询历史记录

### 管理功能

1. 登录页面(login.php)
   - 管理员登录

2. 修改密码(pass.php)
   - 修改管理员密码

3. 系统设置(site.php)
   - 设置网站名称
   - 设置城市名称
   - 设置每页显示记录数
   - 设置百度地图API密钥

4. 站点管理(zhan.php)
   - 站点列表，支持分页和搜索
   - 新增站点
   - 修改站点
   - 删除站点(被线路使用的站点不可删除)

5. 线路管理(xian.php)
   - 线路列表，支持分页和搜索
   - 新增线路
   - 修改线路详情
   - 删除线路

6. 线路站点管理(gaix.php)
   - 管理线路的正向站点和反向站点
   - 添加站点
   - 修改站点
   - 删除站点
   - 批量编辑站点

## 使用注意事项

1. 安装完成后请及时修改默认管理员密码
2. 要使用地图功能，需在系统设置中配置百度地图API密钥
3. 站点坐标可通过百度地图拾取坐标工具获取
4. 线路的zlist和flist字段存储的是站点ID，格式为"-站点ID-站点ID-站点ID-"
5. 新增线路时，可以输入不存在的站点，系统会自动创建
6. 删除站点前，请确保该站点未被任何线路使用
7. 建议定期备份数据库
8. inc目录下的json文件为系统缓存，请勿手动修改

## 联系方式

作者信息: 15058593138@qq.com
